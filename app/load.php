<?php
ini_set('user_agent','Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)');  
ini_set('default_socket_timeout', 550); 
mb_internal_encoding("UTF-8");

$delta = 10;
$oldstate = "/wEPDwUKLTEzNTM5MzU4NQ8WEB4YUHJvamVjdHNJbmZvX1Byb2NlZHVyZUlEAv7///8PHhRQcm9qZWN0c0luZm9fT3BNYXBJRAL/////Dx4VUHJvamVjdHNJbmZvX1JlZ2lvbklEKClZU3lzdGVtLkludDY0LCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkCLTEeF1Byb2plY3RzSW5mb19TZWFyY2hUZXh0ZR4aUHJvamVjdHNJbmZvX051bWJlck9mUGFnZXMCkwUeGFByb2plY3RzSW5mb19DdXJyZW50UGFnZQIMHhdQcm9qZWN0c0luZm9fU29ydENvbHVtbgULQmVuZWZpY2llbnQeFlByb2plY3RzSW5mb19Tb3J0VHJlbmQFA0FTQxYCZg9kFgICAw9kFgwCAQ8PFgIeBFRleHQFf9CY0L3RhNC+0YDQvNCw0YbQuNGP0YLQsCDQtSDQsNC60YLRg9Cw0LvQuNC30LjRgNCw0L3QsCDQvdCwOiAyMC4xMC4yMDEyINCzLg0KINCS0YHQuNGH0LrQuCDRgdGC0L7QudC90L7RgdGC0Lgg0YHQsCDQsiDQu9C10LLQsC5kZAIJDxYCHwgFqQM8YSAgc3R5bGU9ImNvbG9yOiAjMzY1ZDk4OyB0ZXh0LWRlY29yYXRpb246IG5vbmUiIHRhcmdldD0iX3NlbGYiIGhyZWY9IkRlZmF1bHQuYXNweCI+0J/Rg9Cx0LvQuNGH0L3QsCDQuNC90YTQvtGA0LzQsNGG0LjRjy88L2E+PGEgICBzdHlsZT0iY29sb3I6ICMzNjVkOTg7IHRleHQtZGVjb3JhdGlvbjogbm9uZSIgdGFyZ2V0PSJfc2VsZiIgaHJlZj0icHJQcm9jZWR1cmVQcm9qZWN0c0luZm8uYXNweD9jbGVhcj0xP29wPS0xJnByb2M9LTIiPtCf0YDQvtC10LrRgtC4LzwvYT48YSAgc3R5bGU9ImNvbG9yOiAjMzY1ZDk4OyB0ZXh0LWRlY29yYXRpb246IG5vbmUiIHRhcmdldD0iX3NlbGYiIGhyZWY9InByUHJvY2VkdXJlUHJvamVjdHNJbmZvLmFzcHg/Y2xlYXI9MT9vcD0tMSZw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kCDQmCDQrtCW0J3QkCDQptCV0J3QotCg0JDQm9Cd0JAg0JHQqtCb0JPQkNCg0JjQrzsg0K7Qs9C+0LfQsNC/0LDQtNC10L07INCh0L7RhNC40Y8g0LPRgNCw0LRyPGEgaHJlZj0nc3JjaFByb2plY3RJbmZvLmFzcHg/aWQ9NDUyNDMnPtCi0LXRhdC90L7Qu9C+0LPQuNGH0L3QsCDQvNC+0LTQtdGA0L3QuNC30LDRhtC40Y8g0L3QsCDQkNCg0JrQkNCU0JAtMjI8L2E+CiAgIDQ0OSAxODAKICAgMjQ3IDA0OQogICAyMjQgNzMwCiAgIDI0NyAwNDkFMTguMDAS0J/RgNC40LrQu9GO0YfQtdC9ZAIKD2QWAmYPFQogItCQ0KDQndCY0JrQkCDQn9Cb0K7QoSIg0JXQntCe0JSrAdCe0LHQu9Cw0YHRgjog0KHQvtGE0LjRjyDQs9GA0LDQtCBP0LHRidC40L3QsDog0KHRgtC+0LvQuNGH0L3QsCAxMDAwINCh0L7RhNC40Y8g0LPRgC4g0KHQvtGE0LjRjywg0YDQsNC50L7QvSDQmNGB0LrRitGALCDQti7Qui4g0JTRgNGD0LbQsdCwLCDQsdC7LiAyMDksINCy0YUuINCRLCDQsNC/LiAzM5MB0JHRitC70LPQsNGA0LjRjzsg0K7Qk9Ce0JfQkNCf0JDQlNCd0JAg0Jgg0K7QltCd0JAg0KbQldCd0KLQoNCQ0JvQndCQINCR0KrQm9CT0JDQoNCY0K87INCu0LPQvtC30LDQv9Cw0LTQtdC9OyDQodC+0YTQuNGPINCz0YDQsNC0OyDQodGC0L7Qu9C40YfQvdCwnwE8YSBocmVmPSdzcmNoUHJvamVjdEluZm8uYXNweD9pZD0xMDM2Nic+0J/QvtCy0LjRiNCw0LLQsNC90LUg0LrQstCw0LvQuNGE0LjQutCw0YbQuNGP0YLQsCDQvdCwINGB0LvRg9C20LjRgtC10LvQuNGC0LUg0L3QsCAi0JDRgNC90LjQutCwINC/0LvRjtGBIiDQldCe0J7QlDwvYT4JICAgMjcgNTc0CSAgIDI3IDU3NAUgICAgMAkgICAyNyA1NzQEOS4wMBLQn9GA0LjQutC70Y7Rh9C10L1kAhUPDxYOHgxNYXhQYWdlQ291bnQCkwUeDVBhZ2VHcm91cFNpemUCCh4LQ3VycmVudFBhZ2UCDB4MQ3VycmVudEdyb3VwAgIeDU1heEdyb3VwQ291bnQCQh4PTWluUGFnZUZvckdyb3VwAgseD01heFBhZ2VGb3JHcm91cAIUZBYCZg9kFgZmDw8WBB4IQ3NzQ2xhc3NkHgRfIVNCAgJkZAIEDw8WBB4JRm9yZUNvbG9yCgAfFgIEZGQCBg8PFgQfFwqMAR8WAgRkZAIXDw8WAh8IBRXQntCx0Ykg0LHRgNC+0Lk6IDY1ODFkZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WBQURY3RsMDAkaWJ0bkZTZWFyY2gFEGN0bDAwJHR2TWFpbk1lbnUFJGN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkaWJ0blNlYXJjaAUjY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRpYnRuUHJpbnQFNmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkaWJ0blByb2plY3RzTGlzdEV4cG9ydDJFeGNlbIPdRI1lm5gopa10ysLZEwyjyw2W/gHkzNrF2T7zPRvg";
$oldsize=0;

for ($i=20;$i<660;$i++) {
	$t1=microtime(true);
	echo "fetching $i...";

	$data = getPage($i, $oldstate);
	file_put_contents("cache/page_$i.html",$data);
	getState($data);
	if ($oldsize==mb_strlen($data))
		die("повтарящи се данни");
	$oldsize=mb_strlen($data);

	$t2 = round((microtime(true)-$t1)*100)/100;
	echo "\t done. took ".$t2."s";

	if ($t2<$delta) {
		usleep(($delta-$t2)*1000000);
		echo "\t slept ".($delta-$t2)."s";
	}
	echo "\n";
}

function getState($text) {
	global $oldstate;
	$newstate = mb_substr($text,mb_strpos($text,'id="__VIEWSTATE" value="')+24);
	$newstate = mb_substr($newstate,0,mb_strpos($newstate,'"'));
	$oldstate = $newstate;
}

function getPage($i) {
	global $oldstate;
	return http_post("http://umispublic.minfin.bg/prProcedureProjectsInfo.aspx?op=-1&proc=-2&clear=1",array(
		"tvMainMenu_ExpandState" => "ennnnnnnennnnnnnennnenenenen",
		"tvMainMenu_SelectedNode" => "tvMainMenut21",
		"__EVENTTARGET" => 'ctl00$ContentPlaceHolder1$CtlListPager1$'.($i%10==1?'hlNextPage':'hl_'.$i),
		"__EVENTARGUMENT" => "",
		"tvMainMenu_PopulateLog" => "",
		"__VIEWSTATE" => $oldstate,
		'ctl00$txtFastSrch' => "",
		'ctl00$ContentPlaceHolder1$txtSearchText' => ""
	));
}

function http_post($url, $data) {
	if (is_array($data))
		$data_url = http_build_query($data);
	else
		$data_url = $data;
	$data_len = strlen($data_url);
	return file_get_contents ($url, false, stream_context_create (array ('http'=>array(
			'method'=>'POST',
			'header'=>"Content-Length: $data_len\r\n".
				    "Content-type: application/x-www-form-urlencoded\r\n".
				    "Cookie: ASP.NET_SessionId=t4oqdy32ojhootkz04uq11ki\r\n".
				    "Connection: keep-alive\r\n".
				    "Cache-Control: max-age=0",
			'timeout' => 5,
			'max_redirects' => 5
		, 'content'=>$data_url
		))));
}


?>
